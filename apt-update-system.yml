---
- name: Update all servers
  hosts: all

  tasks:
  - name: Update system
    become: true
    apt:
      upgrade: yes
      update_cache: yes
      cache_valid_time: 86400 # 1 day
  
  # - name: Git checkout
  #   ansible.builtin.shell:
  #     chdir: /opt/docker
  #     cmd: git pull

  - name: Pull docker images
    community.docker.docker_compose:
      project_src: /opt/docker/
      pull: true
      state: present
      remove_orphans: true
      register: output
